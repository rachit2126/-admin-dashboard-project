 <!DOCTYPE html>
<html>
<head>
<title>ShopHub</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    font-family:Arial;
    background:#0e0e11;
    color:#f2f2f2;
}

/* Header */
.header{
    background:#111114;
    padding:15px 40px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.logo{
    color:#c8a951;
    font-size:20px;
    font-weight:bold;
}

.nav-links a{
    margin:0 15px;
    text-decoration:none;
    color:#ddd;
}

.profile-btn{
    padding:6px 15px;
    border:1px solid #c8a951;
    background:none;
    color:#c8a951;
    cursor:pointer;
}

/* Hero */
.hero{
    text-align:center;
    padding:60px 20px;
}

/* Products */
.products{
    padding:40px;
}

.product-container{
    display:flex;
    flex-wrap:wrap;
    gap:20px;
    margin-top:20px;
}

.card{
    background:#1a1a1f;
    width:220px;
    padding:15px;
    border-radius:10px;
    text-align:center;
    transition:0.3s;
}

.card:hover{
    transform:translateY(-5px);
    box-shadow:0 5px 20px rgba(0,0,0,0.5);
}

.card img{
    width:100%;
    height:150px;
    object-fit:cover;
    border-radius:8px;
}

.price{
    color:#c8a951;
    margin:10px 0;
    font-weight:bold;
}

.buy-btn{
    background:#c8a951;
    border:none;
    padding:6px 12px;
    cursor:pointer;
}

/* Footer */
.footer{
    background:#111114;
    text-align:center;
    padding:20px;
    margin-top:40px;
}

/* Sidebar */
.profile-sidebar{
    position:fixed;
    top:0;
    right:-300px;
    width:280px;
    height:100%;
    background:#141418;
    padding:20px;
    transition:0.3s;
}

.profile-sidebar.active{
    right:0;
}

.profile-pic{
    width:80px;
    height:80px;
    border-radius:50%;
    background:#c8a951;
    color:black;
    display:flex;
    align-items:center;
    justify-content:center;
    margin:20px auto;
    font-size:24px;
    font-weight:bold;
}

.profile-info div{
    background:#1c1c22;
    padding:8px;
    margin:8px 0;
    border-radius:5px;
}

.edit-input{
    width:100%;
    margin-top:5px;
    padding:5px;
}

.overlay{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.6);
    display:none;
}

.overlay.active{
    display:block;
}
</style>
</head>
<body>

<header class="header">
    <div class="logo">ShopHub</div>
    <div class="nav-links">
        <a href="#">Home</a>
        <a href="#">Products</a>
    </div>
    <button class="profile-btn" onclick="openProfile()">Profile</button>
</header>

<section class="hero">
    <h1>Welcome to ShopHub</h1>
</section>

<section class="products">
    <h2>Products</h2>
    <div id="mainbox" class="product-container"></div>
</section>

<footer class="footer">
    © 2026 ShopHub
</footer>

<div class="overlay" id="overlay" onclick="closeProfile()"></div>

<div class="profile-sidebar" id="sidebar">

    <div style="text-align:right; cursor:pointer;" onclick="closeProfile()">X</div>

    <div class="profile-pic" id="profileInitial">G</div>

    <div class="profile-info">
        <div>
            Name: <span id="profileName">Guest</span>
            <input type="text" id="editName" class="edit-input" style="display:none;">
        </div>
        <div>
            Age: <span id="profileAge">-</span>
            <input type="number" id="editAge" class="edit-input" style="display:none;">
        </div>
        <div>
            Mobile: <span id="profileMobile">-</span>
            <input type="text" id="editMobile" class="edit-input" style="display:none;">
        </div>
    </div>

    <button onclick="editProfile()">Edit</button>
    <button onclick="saveProfile()" id="saveBtn" style="display:none;">Save</button>
    <button onclick="logout()">Logout</button>
     <button id="deactive" onclick="deactive()">Deactivate</button>


</div>

<script>

const USER_API = "http://localhost:3000/users";
const PRODUCT_API = "http://localhost:3000/products";

 
window.onload = function(){

    var user = JSON.parse(localStorage.getItem("currentUser"));

    if(!user){
        window.location.href = "index.html";
    }else{
        loadUser();
        loadProducts();
    }
};

 
async function loadProducts(){

    var res = await fetch(PRODUCT_API);
    var products = await res.json();

    var mainbox = document.getElementById("mainbox");
    mainbox.innerHTML = "";

    for(var i = 0; i < products.length; i++){

        mainbox.innerHTML += `
            <div class="card">
                <img src="${products[i].img}">
                <h4>${products[i].name}</h4>
                <div class="price">₹ ${products[i].price}</div>
                <button class="buy-btn">Add to Cart</button>
            </div>
        `;
    }
}

 
async function loadUser(){

    var currentUser = JSON.parse(localStorage.getItem("currentUser"));

    var res = await fetch(USER_API + "/" + currentUser.id);
    var user = await res.json();

    document.getElementById("profileName").innerHTML = user.username;
    document.getElementById("profileAge").innerHTML = user.age;
    document.getElementById("profileMobile").innerHTML = user.number;

   
}

 
function openProfile(){
    document.getElementById("sidebar").classList.add("active");
    document.getElementById("overlay").classList.add("active");
}

function closeProfile(){
    document.getElementById("sidebar").classList.remove("active");
    document.getElementById("overlay").classList.remove("active");
}

 
function editProfile(){

    var user = JSON.parse(localStorage.getItem("currentUser"));

    document.getElementById("profileName").style.display="none";
    document.getElementById("profileAge").style.display="none";
    document.getElementById("profileMobile").style.display="none";

    document.getElementById("editName").style.display="block";
    document.getElementById("editAge").style.display="block";
    document.getElementById("editMobile").style.display="block";

    document.getElementById("editName").value = user.username;
    document.getElementById("editAge").value = user.age;
    document.getElementById("editMobile").value = user.number;

    document.getElementById("saveBtn").style.display="block";
}

 
async function saveProfile(){

    var name = document.getElementById("editName").value;
    var age = document.getElementById("editAge").value;
    var mobile = document.getElementById("editMobile").value;

    if(name=="" || age=="" || mobile==""){
        alert("All fields required!");
        return;
    }

    var currentUser = JSON.parse(localStorage.getItem("currentUser"));

    var updatedUser = {
        id: currentUser.id,
        username: name,
        pass: currentUser.pass,
        age: age,
        number: mobile,
        
    };

    await fetch(USER_API + "/" + currentUser.id,{
        method:"PUT",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(updatedUser)
    });

    localStorage.setItem("currentUser", JSON.stringify(updatedUser));

    alert("Profile Updated!");
    location.reload();
}

 
function logout(){
    localStorage.removeItem("currentUser");
    window.location.href = "signuppage.html";
}

 async function deactive (params) {
    const deactive = document.getElementById("deactive")
    
 }
 
async function deactive(){

    var confirmAction = confirm("Are you sure you want to deactivate your account?");

    if(!confirmAction){
        return;
    }

    var currentUser = JSON.parse(localStorage.getItem("currentUser"));

    var updatedUser = {
        ...currentUser,
        status: "inactive"
    };

    try{

        await fetch(USER_API + "/" + currentUser.id,{
            method:"PATCH",
            headers:{"Content-Type":"application/json"},
            body: JSON.stringify({ status: "inactive" })
        });

        localStorage.removeItem("currentUser");

        alert("Account Deactivated Successfully");

        window.location.href = "signuppage.html";

    }catch(error){
        alert("Something went wrong");
    }
}


</script>

</body>
</html>
